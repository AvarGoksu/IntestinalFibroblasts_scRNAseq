"0","# Combined faceted plot"
"0",""
"0","facet_labels <- c(""pct_cells"" = ""% of Cells"", ""n_cells_total"" = ""Number of Cells"")"
"0","legend_order <- levels(fct_rev(factor(representation_long$stage_grouped)))"
"0",""
"0","pdf(""/vol/ExtraVol/ParasiteDEX/representations_parasite.pdf"", width=10, height=5)"
"0","ggplot(data = representation_long, aes(x = value, y = fct_rev(identity), fill = stage_grouped)) +"
"0","  geom_bar(stat = ""identity"") +"
"0","  scale_fill_manual(values = (stage_colors), breaks = legend_order) +"
"0","  facet_wrap(~ measure, scales = ""free_x"", labeller = as_labeller(facet_labels)) +"
"0","  theme_minimal(base_size = 15) +"
"0","  theme("
"0","    panel.background = element_blank(),  # Remove panel background"
"0","    plot.background = element_blank(),  # Remove plot background"
"0","    panel.grid.major = element_blank(),  # Remove major grid lines"
"0","    panel.grid.minor = element_blank(),  # Remove minor grid lines"
"0","    axis.line = element_line(color = ""black""),  # Add axis lines"
"0","    legend.position = ""bottom"",  # Place legend at the bottom"
"0","    strip.text = element_text(size = 15),  # Adjust facet label size"
"0","    panel.spacing = unit(0.2, ""lines""),  # Adjust space between facets"
"0","    panel.spacing.x = unit(0.2, ""cm""),  # Adjust horizontal space between facets"
"0","    strip.placement = ""outside"",  # Place facet labels outside the plot"
"0","    plot.margin = margin(10, 10, 10, 10),  # Adjust plot margins"
"0","    plot.tag = element_text(size = 15),  # Adjust size of plot tag"
"0","    panel.grid = element_blank(),  # Remove panel grid lines"
"0","    strip.background = element_blank(),  # Remove strip background"
"0","    plot.tag.position = ""bottomright"",     # Position of plot tag"
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_blank()"
"0","  ) +"
"0","  labs(fill = ""Infection Stage"")  # Label for the legend"
