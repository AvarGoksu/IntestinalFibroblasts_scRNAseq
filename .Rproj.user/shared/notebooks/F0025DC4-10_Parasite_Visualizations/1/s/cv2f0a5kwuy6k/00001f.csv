"0","representation <- dplyr::select(coldata, c(CellName, identity, stage_grouped)) %>%"
"0","  dplyr::group_by(identity, stage_grouped) %>%"
"0","  dplyr::summarise(n_cells = n()) %>%"
"0","  dplyr::ungroup() %>%"
"0","  dplyr::group_by(identity) %>%"
"0","  dplyr::mutate(pct_cells = (n_cells*100)/sum(n_cells),"
"0","                n_cells_total = sum(n_cells)) %>%"
"0","  dplyr::ungroup() %>%"
"0","  dplyr::arrange(desc(n_cells_total))"
"2","`summarise()` has grouped output by 'identity'. You can override using the `.groups` argument."
"0","representation$stage_grouped <- factor(representation$stage_grouped, levels=c(""uninfected_adult"", ""early"", ""peak"", ""repair""))"
"0","representation$identity <- factor(representation$identity, levels=unique(representation$identity))"
"0",""
"0","# Combine the data for both plots"
"0","representation_long <- representation %>%"
"0","  gather(key = ""measure"", value = ""value"", pct_cells, n_cells_total)"
"0","representation_long$measure <- factor(representation_long$measure, levels = c(""pct_cells"",""n_cells_total""))"
"0","representation_long$stage_grouped <- fct_rev(factor(representation_long$stage_grouped, levels=c(""uninfected_adult"", ""early"", ""peak"", ""repair"")))"
